"""Types/Objects for the Fraud Investigation Agent."""

from enum import Enum

from pydantic import BaseModel, Field


class AnalystVerdict(str, Enum):
    """Investigation outcome classification."""

    SUSPICIOUS = "SUSPICIOUS"  # Strong evidence, SAR recommended
    BENIGN = "BENIGN"  # False positive, no SAR needed
    NEEDS_REVIEW = "NEEDS_REVIEW"  # Insufficient evidence, requires senior review


class SuspiciousActivityType(str, Enum):
    """Standard FinCEN SAR Categories."""

    # STRUCTURING: Breaking txns to avoid reporting thresholds (e.g. $9,900)
    STRUCTURING = "structuring"

    # LAYERING: Complex movement to hide origin
    LAYERING = "layering"

    # FUNDS_TRANSFERS: High velocity/volume
    RAPID_MOVEMENT = "suspicious_eft_wire_transfers"

    # OTHERS
    UNUSUAL_VOLUME = "unusual_volume"
    TERRORIST_FINANCING = "terrorist_financing"
    OTHER = "other"


class AnalystResult(BaseModel):
    """The 'Case File' generated by the Analyst, passed through to the Reporter."""

    # Narrative (Context for Reporter)
    summary_narrative: str = Field(..., description="A 2-3 paragraph explanation of the fraud scheme.")
    """2-3 paragraph explanation of the fraud scheme."""

    # Logic
    risk_score: int = Field(..., ge=0, le=100)
    """Risk score assigned by the analyst, ranging from 0 to 100."""

    verdict: AnalystVerdict
    """Investigation outcome classification."""

    # Classification
    suspicious_activity_type: SuspiciousActivityType = Field(
        ..., description="Dominant type of suspicious activity identified."
    )
    """Dominant type of suspicious activity identified."""

    # Hard Evidence
    suspicious_transactions: str
    """List of transaction identifiers deemed suspicious by the analyst."""
